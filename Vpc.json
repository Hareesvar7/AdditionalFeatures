{
    "AWS VPC Policies": {
        "prefix": "vpc",
        "body": [
            "{",
            "    \"policy\": {",
            "        \"name\": \"Enforce Default Security Group is Closed\",",
            "        \"deny\": [",
            "            {",
            "                \"msg\": \"Default security group in VPC '${resource.change.after.name}' is not closed\",",
            "                \"conditions\": [",
            "                    {",
            "                        \"resource\": \"input.resource_changes[_]\",",
            "                        \"type\": \"aws_vpc\",",
            "                        \"property\": \"default_security_group_open\"",
            "                    }",
            "                ]",
            "            }",
            "        ]",
            "    }",
            "}",
            "",
            "{",
            "    \"policy\": {",
            "        \"name\": \"Enforce VPC Flow Logs Enabled\",",
            "        \"deny\": [",
            "            {",
            "                \"msg\": \"VPC '${resource.change.after.name}' does not have flow logs enabled\",",
            "                \"conditions\": [",
            "                    {",
            "                        \"resource\": \"input.resource_changes[_]\",",
            "                        \"type\": \"aws_vpc\",",
            "                        \"property\": \"enable_flow_logs\",",
            "                        \"negate\": true",
            "                    }",
            "                ]",
            "            }",
            "        ]",
            "    }",
            "}",
            "",
            "{",
            "    \"policy\": {",
            "        \"name\": \"Enforce Network ACL Unused Check\",",
            "        \"deny\": [",
            "            {",
            "                \"msg\": \"Network ACL '${resource.change.after.name}' is not in use\",",
            "                \"conditions\": [",
            "                    {",
            "                        \"resource\": \"input.resource_changes[_]\",",
            "                        \"type\": \"aws_network_acl\",",
            "                        \"property\": \"is_used\",",
            "                        \"value\": false",
            "                    }",
            "                ]",
            "            }",
            "        ]",
            "    }",
            "}",
            "",
            "{",
            "    \"policy\": {",
            "        \"name\": \"Enforce VPC Peering DNS Resolution Check\",",
            "        \"deny\": [",
            "            {",
            "                \"msg\": \"VPC Peering Connection '${resource.change.after.name}' does not allow DNS resolution\",",
            "                \"conditions\": [",
            "                    {",
            "                        \"resource\": \"input.resource_changes[_]\",",
            "                        \"type\": \"aws_vpc_peering_connection\",",
            "                        \"property\": \"allow_dns_resolution\",",
            "                        \"negate\": true",
            "                    }",
            "                ]",
            "            }",
            "        ]",
            "    }",
            "}",
            "",
            "{",
            "    \"policy\": {",
            "        \"name\": \"Enforce Security Group Open Only to Authorized Ports\",",
            "        \"deny\": [",
            "            {",
            "                \"msg\": \"Security Group '${resource.change.after.name}' allows access to unauthorized port '${resource.change.after.allowed_ports[_]}'\",",
            "                \"conditions\": [",
            "                    {",
            "                        \"resource\": \"input.resource_changes[_]\",",
